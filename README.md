# Bank_Turnover_Prediction
Модели прогноза вероятности ухода клиента из банка (классификация)

Целью данной работы было на основании исторических данных о поведении клиентов и расторжении договоров с банком обучить модель, предсказывающую уход клиента из банка в ближайшее время со значением `F1-меры` не менее `0.59`.

В процессе работы решались следующие задачи:

1. Провести предобработку данных
2. Подготовить данные для обучения модели
3. Определить способ оценки эффективности моделей
4. Подборать оптимальную модель для решения задачи классификации
4. Подборать наилучшие гиперпараметры
5. Протестировать модель на валидационной и тестовой выборках
6. Проверить наиболее успешную модель на адекватность

При предобработке данных были решены задачи:
- обработки пропусков в данных
- оптимизации типов данных
- очищения от неинтерпретируемых данных

Для подготовки данных к обучению модели и анализа результатов были использованы следующие методы:
- перекодирование данных
- группировка данных
- визуализации данных
- интерпретация взаимозависимостей
- работа с дисбалансом классов

_________________

При первичном анализе данных были выявлены следующие особенности:

Рзные признаки оказывают разную степень влияния на вероятность потери клиента.

В Германии банк потерял каждого третьего клиента (32%) за последний цикл.

Женщины прекращают отношения с банком чаще мужчин (25% и 16% соответственно).

Наличие кредитной карты на отток клиентов никак не влияет.

Активные клиенты (15%) ожидаемо реже уходят из банка, чем неактивные клиенты (27%).

Клиенты, пользующиеся 4-мя продуктами банка (1% пользователей) покинули банк абсолютно все. Также 83% пользователей суммарно 3-х продуктов банка перестали быть его клиентами.

Самыми стабильными оказались обладатели 2-х продуктов банка - более 90% из них остались клиентами банка.

____________________________

Учитывая специфику задачи, способом оценки эффективности моделей были выбраны:
1. `F1-мера` - среднее гармоническое полноты и точности предсказаний модели
2. `AUC-ROC` - баланс полносты положительных и отрицательных классов

Также для оценки точности моделей использовались дополнительные метрики:
- `Accuracy` - общая доля верных ответов (%)
- `Precision` - доля истинно положительных ответов среди всех положительных (точность)
- `Recall` - доля предсказанных положительных среди всех истинно положительных (полнота)
___________________________

Самую высокую F1-меру при применении на тестовой выборке показал алгоритм Случайного Леса (`RandomForestClassifier`) с определенным набором параметров (число деревьев: 39, максимальная глубина дерева: 11, порог положительных значений: 0.31):
- F1-мера: `0.65`
- доля верных ответов: `85.49%`
- доля истинно положительных ответов среди всех положительных: `63.97%`
- доля предсказанных положительных среди всех истинно положительных: `66.04%`
- баланс полноты положительных и отрицательных классов: `0.78`

Таким образом, точность и полнота предсказаний были максимально возможно сбалансированы.

Банк может рассчитывать на точное определение `66%` потенциальных потерь клиентов и своевременно предпринимать для этого необходимые меры, повышая таким образом эффективность своей работы. При этом доля некоректно определенных лояльных клиентов сведена к минимуму и составляет `36%`.

Модель корректно определила лояльность клиентов для `85%` клиентов из тестовой выборки.

__________________

Также были протестированы модели на основе Дерева Решений (DecisionTreeClassifier) и Логистической регрессии (LogisticRegression), показавшие более низкую прогнозную способность.

Дисбаланс классов обрабатывался тремя способами:
- создание "искусственных" объектов миноритарного класса
- уменьшение размерности объектов мажоритарного класса
- увеличение размерности (дублирование) объектов миноритарного класа, 
но наибольшую эффективность показало снижение порога чувствительности к миноритарному классу ("нелояльные/ушедшие" клиенты).

Проверка результирующей модели проводилась путем сравнения точности ее предсказаний с простейшими моделями, которые предполагают принадлежность всех наблюдей к одному превалирующему классу ("клиент остался").
______________________________

По результатам визуализации алгоритма можно сказать, что наибольшую роль при определении тарифного плана играют
- возраст клиента
- количество продуктов
- активность клиента
- баланс
- локация (проживает ли клиент в Германии).

К менее значимым параметрам относятся: 
- клиентский стаж
- предполагаемая зарплата
- гендер
- кредитный рейтинг
- локация (проживает ли клиент в Испании).
